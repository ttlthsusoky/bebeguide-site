# ğŸ“„ ë² ë² ê°€ì´ë“œ ë§ì¶¤í˜• PDF ìë™í™” ì„¤ê³„

**ëª©ì **: ì›”ë ¹ë³„ë¡œ ê°œì¸í™”ëœ "ê·¸ ì•„ê¸° ì „ìš© ê°€ì´ë“œ" PDFë¥¼ ìë™ ìƒì„±í•˜ì—¬ ë¶€ëª¨ì—ê²Œ ì œê³µ

**ì‘ì„±ì¼**: 2025-10-28
**ë²„ì „**: 1.0.0

---

## ğŸ“‹ ëª©í‘œ

í˜„ì¬ëŠ” ì •ì  PDF ë§í¬(`/pdf/checklist-6m.pdf`)ë¥¼ ì´ë©”ì¼ì— ë„£ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

ë‹¤ìŒ ë‹¨ê³„ë¡œ **ë™ì  PDF ìƒì„±**ì„ í†µí•´:
1. ì•„ê¸° ì›”ë ¹ì— ë§ì¶˜ ê°œì¸í™” ì½˜í…ì¸ 
2. ì˜ˆë°©ì ‘ì¢… ì¼ì • ìš”ì•½
3. ì‘ê¸‰ ì‹œ í–‰ë™ ì§€ì¹¨
4. ì œíœ´ ê³ ì§€ ë° ë²•ì  ë©´ì±…
5. ì •ë³´ ê¸°ì¤€ì¼ ëª…ì‹œ

â†’ ë¶€ëª¨ì—ê²Œ "ìš°ë¦¬ ì•„ê¸° ì „ìš© ìë£Œ"ë¼ëŠ” ê°€ì¹˜ë¥¼ ì œê³µí•˜ê³ , ë¸Œëœë“œ ìì‚°ìœ¼ë¡œ í™œìš©

---

## ğŸ¯ í•„ìˆ˜ ì„¹ì…˜ (ë²•ì  ì•ˆì „ì„± í¬í•¨)

ëª¨ë“  PDFì—ëŠ” ë‹¤ìŒ ì„¹ì…˜ì´ **ë°˜ë“œì‹œ** í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤:

### 1. ì›”ë ¹ë³„ ì¤€ë¹„ë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸
- í•„ìˆ˜ ì¤€ë¹„ë¬¼ (ì•ˆì „ ê´€ë ¨)
- ì„ íƒ ì¤€ë¹„ë¬¼ (í¸ì˜ì„±)
- ê° í•­ëª©ë³„ ê°„ë‹¨í•œ ì„¤ëª…

### 2. ì˜ˆë°©ì ‘ì¢… ìŠ¤ì¼€ì¤„ ìš”ì•½
- í•´ë‹¹ ì›”ë ¹ì— ë§ì•„ì•¼ í•  ì˜ˆë°©ì ‘ì¢…
- ë‹¤ìŒ ì˜ˆë°©ì ‘ì¢… ì¼ì •
- ì˜ˆë°©ì ‘ì¢… í›„ ì£¼ì˜ì‚¬í•­

### 3. ì‘ê¸‰ ì‹œ í–‰ë™ ì§€ì¹¨ âš ï¸
```
âš ï¸ ì¦‰ì‹œ 119 ë˜ëŠ” ì‘ê¸‰ì‹¤ë¡œ ê°€ì•¼ í•˜ëŠ” ì¦ìƒ:
- ê³ ì—´ (39ë„ ì´ìƒ)
- í˜¸í¡ê³¤ë€ (ìˆ¨ì„ í—ë–¡ê±°ë¦¼, íŒŒë—ê²Œ ë³€í•¨)
- ê²½ë ¨ ë˜ëŠ” ë°œì‘
- ì˜ì‹ ì €í•˜ (ê¹¨ì›Œë„ ì•ˆ ê¹¨ì–´ë‚¨)
- ì‹¬í•œ íƒˆìˆ˜ (ê¸°ì €ê·€ê°€ 6ì‹œê°„ ì´ìƒ ë§ˆë¦„)

ì´ ë¬¸ì„œëŠ” ì¼ë°˜ì ì¸ ìœ¡ì•„ ì •ë³´ì´ë©°, ì˜ë£Œì§„ì˜ ì§„ë‹¨ì´ë‚˜ ì¹˜ë£Œë¥¼ ëŒ€ì²´í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
```

### 4. ì œíœ´ ê³ ì§€
```
ğŸ“Œ ì œíœ´ ê³ ì§€
ì´ ë¬¸ì„œì—ëŠ” ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ ì œíœ´ ë§í¬ê°€ í¬í•¨ë  ìˆ˜ ìˆìœ¼ë©°,
í•´ë‹¹ ë§í¬ë¥¼ í†µí•´ êµ¬ë§¤ ì‹œ íŒë§¤ìë¡œë¶€í„° ì¼ì •ì•¡ì˜ ìˆ˜ìˆ˜ë£Œë¥¼ ì œê³µë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
êµ¬ë§¤ìì—ê²Œ ì¶”ê°€ ë¹„ìš©ì€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
```

### 5. ì •ë³´ ê¸°ì¤€ì¼ ë° ë©´ì±…
```
ğŸ“… ì •ë³´ ê¸°ì¤€ì¼: 2025-10-28

ì˜ˆë°©ì ‘ì¢… ê¶Œì¥ ì‹œê¸°ì™€ ì˜í•™ì  ê¸°ì¤€ì€ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ,
ìµœì‹  ë‚´ìš©ì€ ë°˜ë“œì‹œ ì†Œì•„ì²­ì†Œë…„ê³¼ ì „ë¬¸ì˜ ë˜ëŠ” ì§ˆë³‘ê´€ë¦¬ì²­ ê³µì§€ì—ì„œ í™•ì¸í•˜ì„¸ìš”.

ë³¸ ìë£ŒëŠ” êµìœ¡ ë° ì •ë³´ ì œê³µ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë˜ì–´ì•¼ í•˜ë©°,
ì „ë¬¸ì ì¸ ì˜ë£Œ ìƒë‹´, ì§„ë‹¨ ë˜ëŠ” ì¹˜ë£Œë¥¼ ëŒ€ì‹ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
```

---

## ğŸ—ï¸ êµ¬í˜„ ë°©ì‹ (2ê°€ì§€ ì˜µì…˜)

### ì˜µì…˜ A: ë¸Œë¼ìš°ì €ì—ì„œ ìƒì„± (jsPDF)

**íë¦„**:
```
ì‚¬ìš©ì í´ë¦­ â†’ script.jsì—ì„œ jsPDFë¡œ PDF ìƒì„±
â†’ Blob ìƒì„± â†’ FormDataì— ì²¨ë¶€ â†’ Workerë¡œ ì „ì†¡
â†’ Workerê°€ ì´ë©”ì¼ì— ì²¨ë¶€íŒŒì¼ë¡œ ì¶”ê°€
```

**ì¥ì **:
- âœ… ì„œë²„ ë¶€ë‹´ ì—†ìŒ
- âœ… ê°œì¸í™” ìš©ì´ (ì´ë¦„, ì‹œê° ë“±)
- âœ… ë¸Œë¼ìš°ì €ì—ì„œ ë¯¸ë¦¬ë³´ê¸° ê°€ëŠ¥

**ë‹¨ì **:
- âŒ ëª¨ë°”ì¼ ì„±ëŠ¥ ì´ìŠˆ ê°€ëŠ¥
- âŒ PDF ìš©ëŸ‰ ì œí•œ (ì´ë©”ì¼ ì²¨ë¶€ í¬ê¸°)

**êµ¬í˜„ ì˜ˆì‹œ**:
```javascript
// script.js
import jsPDF from 'jspdf';

async function generatePersonalizedPDF(month, babyName) {
  const doc = new jsPDF();

  // 1. íƒ€ì´í‹€
  doc.setFontSize(20);
  doc.text(`${babyName}ì˜ ${month}ê°œì›” ê°€ì´ë“œ`, 20, 20);

  // 2. ì¤€ë¹„ë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸
  doc.setFontSize(14);
  doc.text('í•„ìˆ˜ ì¤€ë¹„ë¬¼', 20, 40);
  CHECKLIST[month].forEach((item, idx) => {
    doc.text(`${idx + 1}. ${item}`, 25, 50 + (idx * 10));
  });

  // 3. ì‘ê¸‰ ê²½ê³ 
  doc.setTextColor(255, 0, 0);
  doc.text('âš ï¸ ì‘ê¸‰ ì¦ìƒì€ ì¦‰ì‹œ 119 ë˜ëŠ” ì‘ê¸‰ì‹¤', 20, 100);
  doc.setTextColor(0, 0, 0);

  // 4. ì œíœ´ ê³ ì§€ ë° ë©´ì±…
  doc.setFontSize(10);
  doc.text('ì œíœ´ ê³ ì§€: ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ í™œë™...', 20, 200);
  doc.text('ì •ë³´ ê¸°ì¤€ì¼: 2025-10-28', 20, 210);

  // Blob ìƒì„±
  const blob = doc.output('blob');
  return blob;
}

// í¼ ì œì¶œ ì‹œ
const pdfBlob = await generatePersonalizedPDF(selectedMonth, babyName);
formData.append('pdf_attachment', pdfBlob, `bebeguide-${selectedMonth}m.pdf`);
```

**Worker ìˆ˜ì • í•„ìš”**:
```javascript
// bebeguide-worker.js
const pdfAttachment = formData.get('pdf_attachment');
if (pdfAttachment) {
  // MailChannels attachments í•„ë“œì— ì¶”ê°€
  emailPayload.attachments = [
    {
      filename: `bebeguide-${data.requested_month}m.pdf`,
      content: await pdfAttachment.arrayBuffer(),
      type: 'application/pdf'
    }
  ];
}
```

---

### ì˜µì…˜ B: Workerì—ì„œ ìƒì„± (ì„œë²„ ì‚¬ì´ë“œ)

**íë¦„**:
```
ì‚¬ìš©ì í´ë¦­ â†’ Workerê°€ ìš”ì²­ ë°›ìŒ
â†’ Workerì—ì„œ PDF ìƒì„± (jsPDF ë˜ëŠ” html-to-pdf)
â†’ R2 ìŠ¤í† ë¦¬ì§€ì— ì—…ë¡œë“œ
â†’ R2 Public URLì„ ì´ë©”ì¼ì— ë§í¬ë¡œ ì‚½ì…
```

**ì¥ì **:
- âœ… í´ë¼ì´ì–¸íŠ¸ ì„±ëŠ¥ ë¬´ê´€
- âœ… PDFë¥¼ R2ì— ì €ì¥í•˜ì—¬ ì¬ì‚¬ìš© ê°€ëŠ¥
- âœ… ëª¨ë°”ì¼ ì¹œí™”ì 

**ë‹¨ì **:
- âŒ Worker CPU ì‹œê°„ ì œí•œ (10ms CPU time)
- âŒ R2 ìŠ¤í† ë¦¬ì§€ ë¹„ìš© ë°œìƒ (ë§¤ìš° ì €ë ´)
- âŒ Cloudflare Workersì—ì„œ Canvas API ì œí•œ

**êµ¬í˜„ ì˜ˆì‹œ**:
```javascript
// bebeguide-worker.js
import { jsPDF } from 'jspdf'; // Workers í™˜ê²½ì—ì„œ ì‘ë™ ì—¬ë¶€ í™•ì¸ í•„ìš”

async function generatePDFOnServer(data, env) {
  const doc = new jsPDF();

  // PDF ë‚´ìš© ìƒì„± (ì˜µì…˜ Aì™€ ë™ì¼)
  doc.text(`${data.name}ì˜ ${data.requested_month}ê°œì›” ê°€ì´ë“œ`, 20, 20);
  // ... (ìƒëµ)

  const pdfBuffer = doc.output('arraybuffer');

  // R2ì— ì—…ë¡œë“œ
  const filename = `bebeguide-${data.email}-${data.requested_month}m-${Date.now()}.pdf`;
  await env.PDF_BUCKET.put(filename, pdfBuffer, {
    httpMetadata: {
      contentType: 'application/pdf'
    }
  });

  // Public URL ë°˜í™˜
  return `https://cdn.bebe-guide.com/pdfs/${filename}`;
}

// ì´ë©”ì¼ ì „ì†¡ ì‹œ
const pdfUrl = await generatePDFOnServer(data, env);
// ì´ë©”ì¼ í…œí”Œë¦¿ì— pdfUrl ë§í¬ ì‚½ì…
```

**wrangler.tomlì— R2 ë°”ì¸ë”© ì¶”ê°€**:
```toml
[[r2_buckets]]
binding = "PDF_BUCKET"
bucket_name = "bebeguide-pdfs"
```

---

## ğŸ”’ ë³´ì•ˆ ë° ë²•ì  ê³ ë ¤ì‚¬í•­

### 1. ê°œì¸ì •ë³´ ë³´í˜¸
- âŒ PDF íŒŒì¼ëª…ì— ê°œì¸ ì‹ë³„ ì •ë³´(ì´ë©”ì¼, ì´ë¦„) ë…¸ì¶œ ê¸ˆì§€
- âœ… ëœë¤ UUID ì‚¬ìš© ê¶Œì¥: `${uuidv4()}.pdf`
- âœ… R2 Public URLì— ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ í† í° ì¶”ê°€: `?token=xxx`

### 2. ë²•ì  ë©´ì±…
- **ëª¨ë“  í˜ì´ì§€**ì— í•˜ë‹¨ì— ë‹¤ìŒ ë¬¸êµ¬ ë°˜ë³µ:
  ```
  "ì´ ì •ë³´ëŠ” ì˜ë£Œ ì¡°ì–¸ì´ ì•„ë‹™ë‹ˆë‹¤. ì‘ê¸‰ ì‹œ ì¦‰ì‹œ 119 ë˜ëŠ” ë³‘ì›"
  ```

### 3. ì €ì‘ê¶Œ ë° ë¸Œëœë”©
- PDF í—¤ë”ì— "ë² ë² ê°€ì´ë“œ" ë¡œê³  ë° URL ì‚½ì…
- í‘¸í„°ì— "Â© 2025 ë² ë² ê°€ì´ë“œ. All rights reserved."

### 4. ì ‘ê·¼ ì œì–´
- R2 URLì— **ì‹œê°„ ì œí•œ ì„œëª…** ì¶”ê°€ (7ì¼ í›„ ë§Œë£Œ)
- ë˜ëŠ” R2 Private + Cloudflare Workerë¡œ í”„ë¡ì‹œ

---

## ğŸ“Š êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1 (í˜„ì¬ - ìœ ì§€)
- âœ… ì •ì  PDF ë§í¬ (`/pdf/checklist-6m.pdf`)
- 13ê°œ PDF íŒŒì¼ ìˆ˜ë™ ìƒì„± (0m ~ 12m)

### Phase 2 (ë‹¤ìŒ ë‹¨ê³„ - ê¶Œì¥)
- ğŸ”„ ì˜µì…˜ A (ë¸Œë¼ìš°ì € jsPDF)ë¡œ ì‹œì‘
- ê¸°ë³¸ ë ˆì´ì•„ì›ƒ + ì›”ë ¹ë³„ ì½˜í…ì¸  ìë™ ë Œë”ë§
- ë²•ì  ë©´ì±… ë¬¸êµ¬ ìë™ ì‚½ì…
- ì´ë©”ì¼ ì²¨ë¶€íŒŒì¼ë¡œ ì „ì†¡

### Phase 3 (ì¥ê¸° - ê³ ë„í™”)
- ğŸš€ ì˜µì…˜ B (Worker + R2)ë¡œ ì „í™˜
- ê°œì¸í™” ì‹¬í™” (ì•„ê¸° ì´ë¦„, ìƒë…„ì›”ì¼, ë§ì¶¤ ì¶”ì²œ)
- PDF í…œí”Œë¦¿ ë””ìì¸ ê°œì„  (í°íŠ¸, ìƒ‰ìƒ, ë ˆì´ì•„ì›ƒ)
- ë‹¤ìš´ë¡œë“œ í†µê³„ ìˆ˜ì§‘ (GA ì´ë²¤íŠ¸)

---

## ğŸ› ï¸ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬

### ì˜µì…˜ A (ë¸Œë¼ìš°ì €)
```bash
npm install jspdf
```

### ì˜µì…˜ B (Worker)
```bash
npm install jspdf
# ë˜ëŠ”
npm install html-pdf-node  # Node.js ê¸°ë°˜ì´ë¼ Workersì—ì„œ ì‘ë™ ì•ˆ í•  ìˆ˜ ìˆìŒ
```

**ì£¼ì˜**: Cloudflare WorkersëŠ” ìˆœìˆ˜ JavaScript í™˜ê²½ì´ë¯€ë¡œ, Canvas APIë‚˜ Node.js ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆì´ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸ (PDF ìƒì„± ì „ ê²€ì¦)

- [ ] ëª¨ë“  ë²•ì  ë©´ì±… ë¬¸êµ¬ í¬í•¨ í™•ì¸
- [ ] ì‘ê¸‰ ê²½ê³  ì„¹ì…˜ ëˆˆì— ë„ê²Œ í‘œì‹œ (ë¹¨ê°„ìƒ‰)
- [ ] ì œíœ´ ê³ ì§€ ëª…í™•íˆ í‘œê¸°
- [ ] ì •ë³´ ê¸°ì¤€ì¼ ì—…ë°ì´íŠ¸
- [ ] PDF íŒŒì¼ í¬ê¸° í™•ì¸ (ì´ë©”ì¼ ì²¨ë¶€: <5MB ê¶Œì¥)
- [ ] ëª¨ë°”ì¼ì—ì„œ ê°€ë…ì„± í…ŒìŠ¤íŠ¸
- [ ] ì¸ì‡„ ì‹œ ë ˆì´ì•„ì›ƒ í™•ì¸ (ë¶€ëª¨ê°€ í”„ë¦°íŠ¸í•  ê°€ëŠ¥ì„±)

---

## ğŸ“š ì°¸ê³  ìë£Œ

- **jsPDF ê³µì‹ ë¬¸ì„œ**: https://github.com/parallax/jsPDF
- **Cloudflare R2 ë¬¸ì„œ**: https://developers.cloudflare.com/r2/
- **MailChannels Attachments**: https://mailchannels.zendesk.com/hc/en-us/articles/4565898358413

---

**ë‹¤ìŒ ë‹¨ê³„**: Phase 2 êµ¬í˜„ ì‹œì‘ (ì˜µì…˜ A - ë¸Œë¼ìš°ì € jsPDF)
